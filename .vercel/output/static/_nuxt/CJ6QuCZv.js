import{_ as T}from"./DNA2yJlg.js";import{f as x,r,i as $,j as B,c as i,o as d,a as o,k as m,b as v,t as u,l as y,v as w,m as C,n as _,p as E,d as b,e as M,w as U,_ as L}from"./BWSXKlgt.js";const D={class:"login-container"},I={key:0,class:"error-message"},P={key:1,class:"success-message"},R={class:"form-group"},q={class:"form-group"},F=["disabled"],O={key:2,class:"user-info"},W={class:"register-link"},j=x({__name:"LoginForm",setup(k){const a=r(""),t=r(""),n=r(""),l=r(""),c=r(!1),f=$(),{user:p,setUser:h}=E();B([a,t],()=>{n.value&&(n.value="")});const G=async()=>{try{n.value="",l.value="",c.value=!0;const s=await $fetch("/api/login",{method:"POST",body:{email:a.value,password:t.value}});s.success&&s.user?(l.value=s.message,h(s.user),a.value="",t.value="",setTimeout(()=>{f.push("/dashboard")},1e3)):n.value=s.message||"Login failed"}catch(s){console.error("Login error:",s),n.value="An error occurred during login"}finally{c.value=!1}},A=s=>{l.value="Google login successful",h(s),setTimeout(()=>{f.push("/dashboard")},1e3)},N=s=>{console.error("Google login error:",s)};return(s,e)=>{const V=T,S=M;return d(),i("div",D,[e[6]||(e[6]=o("h2",null,"Login",-1)),n.value?(d(),i("div",I,u(n.value),1)):m("",!0),l.value?(d(),i("div",P,u(l.value),1)):m("",!0),o("form",{onSubmit:C(G,["prevent"])},[o("div",R,[e[2]||(e[2]=o("label",{for:"email"},"Email:",-1)),y(o("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=g=>a.value=g),required:""},null,512),[[w,a.value]])]),o("div",q,[e[3]||(e[3]=o("label",{for:"password"},"Password:",-1)),y(o("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=g=>t.value=g),required:""},null,512),[[w,t.value]])]),o("button",{type:"submit",disabled:c.value},u(c.value?"Logging in...":"Login"),9,F)],32),e[7]||(e[7]=o("div",{class:"separator"},[o("span",null,"OR")],-1)),v(V,{"button-text":"Continue with Google","auth-type":"login",onGoogleAuthSuccess:A,onGoogleAuthError:N}),_(p)?(d(),i("div",O,[o("h3",null,"Welcome, "+u(_(p).name)+"!",1),o("p",null,"You are now logged in as "+u(_(p).account_type)+".",1)])):m("",!0),o("div",W,[e[5]||(e[5]=b(" Don't have an account? ")),v(S,{to:"/register"},{default:U(()=>e[4]||(e[4]=[b("Register")])),_:1,__:[4]})])])}}}),Y=L(j,[["__scopeId","data-v-f3d5a3f1"]]),z={class:"login-page"},H=x({__name:"login",setup(k){return(a,t)=>{const n=Y;return d(),i("div",z,[t[0]||(t[0]=o("h1",null,"Welcome to Nixty",-1)),t[1]||(t[1]=o("p",{class:"subtitle"},"Please log in to access your account",-1)),v(n)])}}}),Q=L(H,[["__scopeId","data-v-e4e701e6"]]);export{Q as default};
