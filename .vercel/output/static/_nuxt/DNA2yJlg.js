import{f as b,r as c,h as k,c as d,o as h,F as T,a as p,k as F,q as E,d as v,t as f,m as A,_ as I}from"./BWSXKlgt.js";function x(){return{GOOGLE_CLIENT_ID:"945372800834-dol8edtdutc6jfocc8g11pnm731bmu4o.apps.googleusercontent.com"}}const z=["disabled"],O={key:0,class:"error-message"},L=b({__name:"GoogleButton",props:{buttonText:{},authType:{}},emits:["google-auth-success","google-auth-error"],setup(u,{emit:m}){const _=u,a=m,r=c(!1),o=c(!1),t=c(""),{GOOGLE_CLIENT_ID:w}=x();let i=null;k(()=>{if(typeof window<"u"){const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,document.head.appendChild(e),e.onload=G,e.onerror=()=>{o.value=!0,t.value="Failed to load Google authentication. Please check your internet connection."}}});const G=()=>{typeof window<"u"&&window.google&&(i=window.google.accounts.oauth2.initTokenClient({client_id:w,scope:"email profile",callback:C,error_callback:y}))},y=e=>{console.error("Google OAuth error:",e),r.value=!1,o.value=!0,t.value="Google authentication failed. Please try again.",a("google-auth-error","Google authentication failed")},g=async()=>{if(o.value=!1,t.value="",!i){o.value=!0,t.value="Google authentication not initialized. Please refresh the page and try again.",a("google-auth-error","Google authentication not initialized");return}r.value=!0;try{i.requestAccessToken()}catch(e){console.error("Error requesting access token:",e),r.value=!1,o.value=!0,t.value="Failed to start Google authentication. Please try again."}},C=async e=>{try{if(e.error){e.error==="popup_closed_by_user"?(o.value=!0,t.value="Google sign-in was cancelled. Please try again."):(o.value=!0,t.value=`Google authentication error: ${e.error}`),a("google-auth-error",e.error),r.value=!1;return}const l=e.access_token,s=await(await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${l}`}})).json(),n=await $fetch(`/api/auth/google-${_.authType}`,{method:"POST",body:{email:s.email,name:s.name,google_id:s.sub,picture:s.picture}});n.success&&n.user?a("google-auth-success",n.user):(o.value=!0,t.value=n.message||"Authentication failed on the server.",a("google-auth-error",n.message))}catch(l){console.error("Google authentication error:",l),o.value=!0,t.value="Failed to authenticate with Google. Please try again.",a("google-auth-error","Failed to authenticate with Google")}finally{r.value=!1}};return(e,l)=>(h(),d(T,null,[p("button",{onClick:g,class:"google-button",disabled:r.value},[l[0]||(l[0]=E('<span class="google-icon" data-v-e349a9b4><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="24" height="24" data-v-e349a9b4><path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z" data-v-e349a9b4></path><path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z" data-v-e349a9b4></path><path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z" data-v-e349a9b4></path><path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z" data-v-e349a9b4></path></svg></span>',1)),v(" "+f(e.buttonText),1)],8,z),o.value?(h(),d("div",O,[v(f(t.value)+" ",1),p("a",{href:"#",onClick:A(g,["prevent"])},"Try again")])):F("",!0)],64))}}),P=I(L,[["__scopeId","data-v-e349a9b4"]]);export{P as _};
