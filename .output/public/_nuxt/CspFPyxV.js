import{_ as S,n as D,r as u,j as I,c as n,a as s,s as y,t as i,z as A,g as M,F as B,y as N,k as O,o as a}from"./BxhkHZUn.js";import{u as U}from"./YVwmBCuj.js";import"./DUhoTqhP.js";const x={class:"transaction-detail-page"},z={class:"container"},J={class:"page-header"},K={key:0,class:"loading-state"},R={key:1,class:"error-state"},V={key:2,class:"transaction-content"},Y={class:"transaction-info galaxy-card"},j={class:"info-grid"},q={class:"info-item"},G={class:"order-id"},H={class:"info-item"},Q={class:"info-item"},W={class:"info-item"},X={class:"payment-method"},Z={class:"info-item"},ss={class:"info-item"},ts={class:"amount"},es={key:0,class:"license-section"},os={class:"license-header"},ns=["disabled"],as={key:0},ls={key:1},is={key:0,class:"license-loading"},rs={key:1,class:"license-error"},ds={key:2,class:"license-cards"},us={class:"license-header"},cs={class:"license-type"},vs={class:"license-content"},ps={key:0,class:"license-field"},_s={class:"license-value"},ys=["value","id"],ms=["onClick"],fs={key:1,class:"license-field"},gs={class:"license-value"},bs=["value","id"],ks=["onClick"],hs={class:"license-value"},Cs=["type","value","id"],ws=["onClick"],Ps=["onClick"],Ts={key:2,class:"license-field"},Ls={class:"additional-info"},$s={key:3,class:"no-license"},Es={key:1,class:"pending-message"},Fs={key:2,class:"failed-message"},Ss={__name:"[id]",setup(Ds){const w=O(),{user:f,initUser:P}=D(),{formatCurrency:T}=U(),l=u(null),g=u(!0),v=u(null),b=u([]),p=u(!1),_=u(null),c=u({}),C=async()=>{try{g.value=!0,v.value=null;const e=w.params.id,t=await $fetch(`/api/profile/transactions/${e}`,{headers:{"x-user-session":JSON.stringify(f.value)}});t.success?(l.value=t.transaction,t.transaction.status==="completed"&&await m()):v.value=t.message||"Failed to load transaction"}catch(e){console.error("Error loading transaction:",e),v.value=e.message||"Failed to load transaction details"}finally{g.value=!1}},m=async()=>{try{p.value=!0,_.value=null;const e=await $fetch("/api/profile/transactions/get-license",{method:"POST",headers:{"x-user-session":JSON.stringify(f.value)},body:{order_id:l.value.order_id}});e.success?(b.value=e.licenses,c.value={},e.licenses.forEach((t,d)=>{c.value[d]=!1})):_.value=e.message||"Failed to load license information"}catch(e){console.error("Error loading license:",e),_.value=e.message||"Failed to load license information"}finally{p.value=!1}},L=e=>({pending:"Pending",completed:"Completed",failed:"Failed",cancelled:"Cancelled"})[e]||e,$=e=>({product_key:"Product Key",email_password:"Email & Password"})[e]||e,E=e=>new Date(e).toLocaleString(),F=e=>{c.value[e]=!c.value[e]},k=async(e,t)=>{try{await navigator.clipboard.writeText(e);const d=document.querySelector(`#${t} + .copy-button`);if(d){const o=d.textContent;d.textContent="‚úÖ Copied!",setTimeout(()=>{d.textContent=o},2e3)}}catch{const o=document.getElementById(t);o&&(o.select(),document.execCommand("copy"))}};return I(()=>{P(),f.value&&C()}),(e,t)=>{var d;return a(),n("div",x,[s("div",z,[s("div",J,[t[1]||(t[1]=s("h1",null,"Transaction Details",-1)),s("button",{onClick:t[0]||(t[0]=o=>e.$router.back()),class:"back-button"}," ‚Üê Back to Transactions ")]),g.value?(a(),n("div",K,t[2]||(t[2]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"Loading transaction details...",-1)]))):v.value?(a(),n("div",R,[t[3]||(t[3]=s("div",{class:"error-icon"},"!",-1)),t[4]||(t[4]=s("h2",null,"Error",-1)),s("p",null,i(v.value),1),s("button",{onClick:C,class:"retry-button"},"Try Again")])):l.value?(a(),n("div",V,[s("div",Y,[t[11]||(t[11]=s("h2",null,"Transaction Information",-1)),s("div",j,[s("div",q,[t[5]||(t[5]=s("label",null,"Order ID:",-1)),s("span",G,i(l.value.order_id),1)]),s("div",H,[t[6]||(t[6]=s("label",null,"Product:",-1)),s("span",null,i(l.value.product_name),1)]),s("div",Q,[t[7]||(t[7]=s("label",null,"Status:",-1)),s("span",{class:A(["status-badge",l.value.status])},i(L(l.value.status)),3)]),s("div",W,[t[8]||(t[8]=s("label",null,"Payment Method:",-1)),s("span",X,i((d=l.value.payment_method)==null?void 0:d.toUpperCase()),1)]),s("div",Z,[t[9]||(t[9]=s("label",null,"Date:",-1)),s("span",null,i(E(l.value.created_at)),1)]),s("div",ss,[t[10]||(t[10]=s("label",null,"Amount:",-1)),s("span",ts,i(M(T)(l.value.amount)),1)])])]),l.value.status==="completed"?(a(),n("div",es,[s("div",os,[t[12]||(t[12]=s("h2",null,"Your License Information",-1)),s("button",{onClick:m,class:"refresh-button",disabled:p.value},[p.value?(a(),n("span",as,"Loading...")):(a(),n("span",ls,"üîÑ Refresh"))],8,ns)]),p.value?(a(),n("div",is,t[13]||(t[13]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"Loading license information...",-1)]))):_.value?(a(),n("div",rs,[s("p",null,i(_.value),1),s("button",{onClick:m,class:"retry-button"},"Try Again")])):b.value.length>0?(a(),n("div",ds,[(a(!0),n(B,null,N(b.value,(o,r)=>(a(),n("div",{key:r,class:"license-card galaxy-card"},[s("div",us,[s("h3",null,"License "+i(r+1),1),s("span",cs,i($(o.license_type)),1)]),s("div",vs,[o.product_key?(a(),n("div",ps,[t[14]||(t[14]=s("label",null,"Product Key:",-1)),s("div",_s,[s("input",{value:o.product_key,readonly:"",class:"license-input",id:"key-"+r},null,8,ys),s("button",{onClick:h=>k(o.product_key,"key-"+r),class:"copy-button"}," üìã Copy ",8,ms)])])):y("",!0),o.email&&o.password?(a(),n("div",fs,[t[15]||(t[15]=s("label",null,"Email:",-1)),s("div",gs,[s("input",{value:o.email,readonly:"",class:"license-input",id:"email-"+r},null,8,bs),s("button",{onClick:h=>k(o.email,"email-"+r),class:"copy-button"}," üìã Copy ",8,ks)]),t[16]||(t[16]=s("label",null,"Password:",-1)),s("div",hs,[s("input",{type:c.value[r]?"text":"password",value:o.password,readonly:"",class:"license-input",id:"password-"+r},null,8,Cs),s("button",{onClick:h=>F(r),class:"toggle-button"},i(c.value[r]?"üëÅÔ∏è":"üëÅÔ∏è‚Äçüó®Ô∏è"),9,ws),s("button",{onClick:h=>k(o.password,"password-"+r),class:"copy-button"}," üìã Copy ",8,Ps)])])):y("",!0),o.additional_info?(a(),n("div",Ts,[t[17]||(t[17]=s("label",null,"Additional Information:",-1)),s("div",Ls,i(o.additional_info),1)])):y("",!0)])]))),128))])):(a(),n("div",$s,[t[18]||(t[18]=s("p",null,"No license information available for this transaction.",-1)),s("button",{onClick:m,class:"retry-button"},"Check Again")]))])):l.value.status==="pending"?(a(),n("div",Es,t[19]||(t[19]=[s("h3",null,"‚è≥ Payment Pending",-1),s("p",null,"Your payment is being processed. License information will be available once payment is confirmed.",-1)]))):l.value.status==="failed"?(a(),n("div",Fs,t[20]||(t[20]=[s("h3",null,"‚ùå Payment Failed",-1),s("p",null,"This transaction failed. Please try again or contact support.",-1)]))):y("",!0)])):y("",!0)])])}}},Bs=S(Ss,[["__scopeId","data-v-1e7224a2"]]);export{Bs as default};
