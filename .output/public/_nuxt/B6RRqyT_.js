import{r,j as h,k,c as l,a as s,s as c,t as w,M as R,A as f,C as g,i as _,o as u}from"./BxhkHZUn.js";const M={class:"reset-password-page"},S={class:"form-container"},q={key:0,class:"error-message"},C={key:1,class:"success-message"},V={class:"form-group"},x={class:"form-group"},A=["disabled"],B={key:3,class:"success-container"},D={__name:"reset-password",setup(N){const y=k(),b=_(),p=r(""),t=r(""),n=r(""),a=r(""),d=r(""),i=r(!1),v=r(!1);h(()=>{var o;p.value=((o=y.query.token)==null?void 0:o.toString())||"",p.value||(a.value="Invalid reset token. Please request a new password reset link.")});const P=async()=>{try{if(a.value="",d.value="",t.value!==n.value){a.value="Passwords do not match.";return}if(t.value.length<8){a.value="Password must be at least 8 characters long.";return}i.value=!0;const o=await $fetch("/api/reset-password",{method:"POST",body:{token:p.value,password:t.value}});o.success?(d.value=o.message,t.value="",n.value="",v.value=!0,setTimeout(()=>{b.push("/home")},2e3)):a.value=o.message||"An error occurred"}catch(o){console.error("Reset password error:",o),a.value="An error occurred. Please try again."}finally{i.value=!1}};return(o,e)=>(u(),l("div",M,[e[6]||(e[6]=s("h1",null,"Reset Password",-1)),e[7]||(e[7]=s("p",{class:"subtitle"},"Create a new password for your account.",-1)),s("div",S,[a.value?(u(),l("div",q,w(a.value),1)):c("",!0),d.value?(u(),l("div",C,w(d.value),1)):c("",!0),v.value?c("",!0):(u(),l("form",{key:2,onSubmit:R(P,["prevent"])},[s("div",V,[e[2]||(e[2]=s("label",{for:"password"},"New Password",-1)),f(s("input",{type:"password",id:"password","onUpdate:modelValue":e[0]||(e[0]=m=>t.value=m),placeholder:"Enter new password",required:"",minlength:"8"},null,512),[[g,t.value]]),e[3]||(e[3]=s("small",{class:"password-hint"},"Password must be at least 8 characters long",-1))]),s("div",x,[e[4]||(e[4]=s("label",{for:"confirmPassword"},"Confirm Password",-1)),f(s("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":e[1]||(e[1]=m=>n.value=m),placeholder:"Re-enter new password",required:""},null,512),[[g,n.value]])]),s("button",{type:"submit",class:"submit-button",disabled:i.value},w(i.value?"Resetting...":"Reset Password"),9,A)],32)),v.value?(u(),l("div",B,e[5]||(e[5]=[s("p",null,"Your password has been reset successfully!",-1),s("p",{class:"redirect-message"},"Redirecting to home page...",-1)]))):c("",!0)])]))}};export{D as default};
